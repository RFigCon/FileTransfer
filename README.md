Despite having Windows headers, this has not been tested on Windows.

Not currently thread safe, should not be used with more than 1 client at a time.

